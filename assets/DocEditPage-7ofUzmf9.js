import{s as E,_ as C,r as u,o as L,E as d,b as m,w as P,e as t,f as B,d as s,h as c,i,u as F,A as U,F as _,j as p,q as M,g as N,k as b}from"./index-7NJvaBin.js";import{m as $}from"./markdown-KRDkjSXG.js";import{g as j}from"./PageManPage-C-PhHqHG.js";import q from"./FilesManPage-CMkhN5oD.js";const z=async f=>{try{return(await E.post("/api/documents.php",f)).data}catch(e){throw console.error("创建文档失败:",e),e.response?(console.error("创建文档失败详情:",e.response.data),new Error(e.response.data.message||"创建失败")):e}},A={class:"docsbox-doc-edit-container"},S={class:"docsbox-doc-header-container"},T={class:"docsbox-doc-header"},h={class:"docsbox-doc-editor"},G={class:"docsbox-doc-footer"},H={__name:"DocEditPage",setup(f){const e=u({name:"",pageId:"",content:""}),v=u(!1),r=u(),l=u(!1);L(async()=>{await w()});const w=async()=>{try{l.value=!0,r.value=await j(),r.value&&r.value.length>0&&(e.value.pageId=r.value[0].id)}catch(n){d.error("获取页面列表失败"),console.error("获取页面列表失败:",n)}finally{l.value=!1}},V=async()=>{if(!e.value.name||e.value.name.trim()===""){d.warning("请输入文档名称");return}if(!e.value.pageId){d.warning("请选择所属页面");return}try{l.value=!0;const n=await z(e.value);d.success("文档创建成功"),e.value={name:"",pageId:e.value.pageId,content:""}}catch(n){console.error("创建文档失败:",n),d.error(n.message||"创建文档失败")}finally{l.value=!1}};return(n,a)=>{const y=i("el-option"),x=i("el-select"),k=i("el-input"),g=i("el-button"),I=i("el-drawer"),D=B("loading");return p(),m(_,null,[P((p(),m("div",A,[s("div",S,[s("div",T,[a[6]||(a[6]=s("span",null,"页面：",-1)),t(x,{modelValue:e.value.pageId,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.pageId=o),placeholder:"Select",disabled:l.value},{default:c(()=>[(p(!0),m(_,null,M(r.value,o=>(p(),N(y,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"]),a[7]||(a[7]=s("span",null,"名称：",-1)),t(k,{modelValue:e.value.name,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.name=o),placeholder:"请输入文档名称",disabled:l.value},null,8,["modelValue","disabled"])]),s("div",null,[t(g,{type:"primary",icon:F(U),onClick:a[2]||(a[2]=o=>v.value=!0)},{default:c(()=>[...a[8]||(a[8]=[b("文件管理",-1)])]),_:1},8,["icon"])])]),s("div",h,[t($,{modelValue:e.value.content,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.content=o),disabled:l.value,onLoading:a[4]||(a[4]=o=>l.value=!1)},null,8,["modelValue","disabled"])]),s("div",G,[t(g,{type:"primary",onClick:V,loading:l.value,disabled:l.value},{default:c(()=>[...a[9]||(a[9]=[b(" 创建 ",-1)])]),_:1},8,["loading","disabled"])])])),[[D,l.value]]),t(I,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=o=>v.value=o),title:"文件管理",size:"100%",direction:"btt"},{default:c(()=>[t(q)]),_:1},8,["modelValue"])],64)}}},R=C(H,[["__scopeId","data-v-0fe963af"]]);export{R as default};
